<!DOCTYPE html>
<html lang="ja">
<head>
    <title>Firebase 接続テスト (修正版)</title>
    <style>
        body { font-family: sans-serif; padding: 2em; }
        #status { font-weight: bold; font-size: 1.5em; }
    </style>
</head>
<body>
    <h1>Firebase 接続テスト (修正版)</h1>
    <p>ブラウザのコンソール（F12キー）を開いて、詳細なログを確認してください。</p>
    <p>結果: <span id="status">テスト中...</span></p>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

        const statusEl = document.getElementById('status');
        console.log("1. スクリプトの実行を開始します。");

        const firebaseConfig = {
            apiKey: "AIzaSyA0D7fOnIvQFU3O29q6bb_6gj5tWN23N0s",
            authDomain: "memory-game-10e98.firebaseapp.com",
            databaseURL: "https://memory-game-10e98-default-rtdb.firebaseio.com",
            projectId: "memory-game-10e98",
            storageBucket: "memory-game-10e98.firebasestorage.app",
            messagingSenderId: "435852264433",
            appId: "1:435852264433:web:0ef957830b634b9eb13a50",
            measurementId: "G-8GN7P9PFX7"
        };

        try {
            console.log("2. Firebaseを初期化します...");
            const app = initializeApp(firebaseConfig);
            console.log("3. Firebaseアプリの初期化に成功しました。");
            
            const database = getDatabase(app);
            console.log("4. データベースインスタンスの取得に成功しました。");

            statusEl.textContent = 'Firebase初期化成功。データベースへ接続試行中...';
            statusEl.style.color = 'blue';

            // ★エラー修正: 無効なパス ".ref" を、データベースのルートを示す "/" に修正
            const testRef = ref(database, '/');
            
            get(testRef).then(() => {
                console.log("5. データベースへの接続に成功しました。");
                statusEl.textContent = '成功: Firebase Realtime Databaseに接続できました！';
                statusEl.style.color = 'green';
            }).catch(error => {
                console.error("データベース接続エラー:", error);
                statusEl.textContent = 'エラー: データベースに接続できませんでした。Firebaseコンソールの「ルール」を確認してください。';
                statusEl.style.color = 'orange';
            });

        } catch (e) {
            console.error("Firebaseの初期化中に致命的なエラーが発生しました:", e);
            statusEl.textContent = '致命的エラー: Firebaseを初期化できませんでした。';
            statusEl.style.color = 'red';
        }
    </script>
</body>
</html>
